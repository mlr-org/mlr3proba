<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot for PredictionSurv — autoplot.PredictionSurv • mlr3proba</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot for PredictionSurv — autoplot.PredictionSurv"><meta name="description" content="Generates plots for PredictionSurv, depending on argument type:
&quot;calib&quot; (default): Calibration plot comparing the average predicted
survival distribution (Pred) to a Kaplan-Meier prediction (KM), this is
not a comparison of a stratified crank or lp.
&quot;dcalib&quot;: Distribution calibration plot.
A model is considered D-calibrated if, for any given quantile p, the
proportion of observed outcomes occurring before the predicted time quantile,
matches p. For example, 50% of events should occur before the predicted
median survival time (i.e. the time corresponding to a predicted survival
probability of 0.5).
Good calibration means that the resulting line plot will lie close to the
straight line \(y = x\).
Note that we impute NAs from the predicted quantile function with the
maximum observed outcome time.
&quot;scalib&quot;: Smoothed calibration plot at a specific time point.
For a range of probabilities of event occurrence in \([0,1]\) (x-axis),
the y-axis has the smoothed observed proportions calculated using hazard
regression (model is fitted using the predicted probabilities).
See Austin et al. (2020) and MeasureSurvICI for more details.
Good calibration means that the resulting line plot will lie close to the
straight line \(y = x\).
&quot;isd&quot;: Plot the predicted individual survival distributions
(survival curves) for the test set's observations.

"><meta property="og:description" content="Generates plots for PredictionSurv, depending on argument type:
&quot;calib&quot; (default): Calibration plot comparing the average predicted
survival distribution (Pred) to a Kaplan-Meier prediction (KM), this is
not a comparison of a stratified crank or lp.
&quot;dcalib&quot;: Distribution calibration plot.
A model is considered D-calibrated if, for any given quantile p, the
proportion of observed outcomes occurring before the predicted time quantile,
matches p. For example, 50% of events should occur before the predicted
median survival time (i.e. the time corresponding to a predicted survival
probability of 0.5).
Good calibration means that the resulting line plot will lie close to the
straight line \(y = x\).
Note that we impute NAs from the predicted quantile function with the
maximum observed outcome time.
&quot;scalib&quot;: Smoothed calibration plot at a specific time point.
For a range of probabilities of event occurrence in \([0,1]\) (x-axis),
the y-axis has the smoothed observed proportions calculated using hazard
regression (model is fitted using the predicted probabilities).
See Austin et al. (2020) and MeasureSurvICI for more details.
Good calibration means that the resulting line plot will lie close to the
straight line \(y = x\).
&quot;isd&quot;: Plot the predicted individual survival distributions
(survival curves) for the test set's observations.

"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlr3proba</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="external-link dropdown-item" href="https://survival-org.github.io/user2024-survival-mlr3/">userR! 2024 Tutorial</a></li>
    <li><a class="external-link dropdown-item" href="https://mlr3book.mlr-org.com/chapters/chapter13/beyond_regression_and_classification.html#sec-survival">Survival Analysis (mlr3 book)</a></li>
    <li><a class="external-link dropdown-item" href="https://mlr3book.mlr-org.com/chapters/chapter13/beyond_regression_and_classification.html#sec-density">Density Estimation (mlr3 book)</a></li>
    <li><a class="external-link dropdown-item" href="https://mlr-org.com/gallery/technical/2023-10-25-bart-survival/">Survival Modeling using BART</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-book"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/mlr3proba/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/" aria-label="Mattermost"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3" aria-label="Stack Overflow"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/" aria-label="mlr3 website"><span class="fa fa-link"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot for PredictionSurv</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3proba/blob/v0.8.3/R/autoplot.R" class="external-link"><code>R/autoplot.R</code></a></small>
      <div class="d-none name"><code>autoplot.PredictionSurv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates plots for <a href="PredictionSurv.html">PredictionSurv</a>, depending on argument <code>type</code>:</p><ul><li><p><code>"calib"</code> (default): <strong>Calibration plot</strong> comparing the average predicted
survival distribution (<code>Pred</code>) to a Kaplan-Meier prediction (<code>KM</code>), this is
<em>not</em> a comparison of a stratified <code>crank</code> or <code>lp</code>.</p></li>
<li><p><code>"dcalib"</code>: <strong>Distribution calibration plot</strong>.
A model is considered D-calibrated if, for any given quantile <code>p</code>, the
proportion of observed outcomes occurring before the predicted time quantile,
matches <code>p</code>. For example, 50% of events should occur before the predicted
median survival time (i.e. the time corresponding to a predicted survival
probability of 0.5).
Good calibration means that the resulting line plot will lie close to the
straight line \(y = x\).
Note that we impute <code>NA</code>s from the predicted quantile function with the
maximum observed outcome time.</p></li>
<li><p><code>"scalib"</code>: <strong>Smoothed calibration plot</strong> at a specific time point.
For a range of probabilities of event occurrence in \([0,1]\) (x-axis),
the y-axis has the smoothed observed proportions calculated using hazard
regression (model is fitted using the predicted probabilities).
See Austin et al. (2020) and <a href="mlr_measures_surv.calib_index.html">MeasureSurvICI</a> for more details.
Good calibration means that the resulting line plot will lie close to the
straight line \(y = x\).</p></li>
<li><p><code>"isd"</code>: Plot the predicted <strong>i</strong>ndividual <strong>s</strong>urvival <strong>d</strong>istributions
(survival curves) for the test set's observations.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'PredictionSurv'</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"calib"</span>,</span>
<span>  times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cuts <span class="op">=</span> <span class="fl">11L</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theme <span class="op">=</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>(<a href="PredictionSurv.html">PredictionSurv</a>).</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>(<code>character(1)</code>) <br>
Type of the plot, see Description.</p></dd>


<dt id="arg-times">times<a class="anchor" aria-label="anchor" href="#arg-times"></a></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code>) <br>
If <code>type = "calib"</code> then <code>times</code> is the values on the x-axis to plot over.
If <code>NULL</code>, we use all time points from the predicted survival matrix (<code>object$data$distr</code>).</p></dd>


<dt id="arg-row-ids">row_ids<a class="anchor" aria-label="anchor" href="#arg-row-ids"></a></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code>) <br>
If <code>type = "isd"</code>, specific observation ids (from the test set) for which
we draw their predicted survival distributions.</p></dd>


<dt id="arg-cuts">cuts<a class="anchor" aria-label="anchor" href="#arg-cuts"></a></dt>
<dd><p>(<code>integer(1)</code>) <br>
If <code>type = "calib"</code>, number of cuts in \((0,1)\), which define the bins on
the x-axis of the D-calibration plot. Default is <code>11</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>(<code>numeric(1)</code>) <br>
If <code>type = "scalib"</code>, a specific time point at which the smoothed calibration
plot is constructed.</p></dd>


<dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>(<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code>)<br>
The <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_minimal()</a></code> is applied by default to all plots.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(<code>any</code>):
Additional arguments, currently unused.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a></h2>


<ol><li><p><code>object</code> must have a <code>distr</code> prediction, as all plot <code>type</code>s use the
predicted survival distribution/matrix.</p></li>
<li><p><code>type = "dcalib"</code> is drawn a bit differently from Haider et al. (2020),
though its still conceptually the same.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Haider, Humza, Hoehn, Bret, Davis, Sarah, Greiner, Russell (2020).
“Effective Ways to Build and Evaluate Individual Survival Distributions.”
<em>Journal of Machine Learning Research</em>, <b>21</b>(85), 1–63.
<a href="https://jmlr.org/papers/v21/18-772.html" class="external-link">https://jmlr.org/papers/v21/18-772.html</a>.</p>
<p>Austin, C. P, Harrell, E. F, van Klaveren, David (2020).
“Graphical calibration curves and the integrated calibration index (ICI) for survival models.”
<em>Statistics in Medicine</em>, <b>39</b>(21), 2714.
ISSN 10970258, <a href="https://doi.org/10.1002/SIM.8570" class="external-link">doi:10.1002/SIM.8570</a>
, <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC7497089/" class="external-link">https://pmc.ncbi.nlm.nih.gov/articles/PMC7497089/</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"surv.coxph"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">task</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">tsk</a></span><span class="op">(</span><span class="st">"gbcs"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">=</span> <span class="va">learner</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span>, row_ids <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task</span>, row_ids <span class="op">=</span> <span class="fl">601</span><span class="op">:</span><span class="fl">686</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calibration by comparison of average prediction to Kaplan-Meier</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.PredictionSurv-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># same as above, use specific time points</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1000</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.PredictionSurv-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Distribution-calibration (D-Calibration)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p</span>, type <span class="op">=</span> <span class="st">"dcalib"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.PredictionSurv-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Smoothed Calibration (S-Calibration)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p</span>, type <span class="op">=</span> <span class="st">"scalib"</span>, time <span class="op">=</span> <span class="fl">1750</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: polspline</span>
<span class="r-plt img"><img src="autoplot.PredictionSurv-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predicted survival curves (all observations)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p</span>, type <span class="op">=</span> <span class="st">"isd"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.PredictionSurv-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predicted survival curves (specific observations)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">p</span>, type <span class="op">=</span> <span class="st">"isd"</span>, row_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">601</span>, <span class="fl">651</span>, <span class="fl">686</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="autoplot.PredictionSurv-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphael Sonabend, Franz Kiraly, Michel Lang, John Zobolas, Philip Studener.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

