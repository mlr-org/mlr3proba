<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>D-Calibration Survival Measure — mlr_measures_surv.dcalib • mlr3proba</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="D-Calibration Survival Measure — mlr_measures_surv.dcalib"><meta name="description" content="
This calibration method is defined by calculating the following statistic:
$$s = B/n \sum_i (P_i - n/B)^2$$
where \(B\) is number of 'buckets' (that equally divide \([0,1]\) into intervals),
\(n\) is the number of predictions, and \(P_i\) is the observed proportion
of observations in the \(i\)th interval. An observation is assigned to the
\(i\)th bucket, if its predicted survival probability at the time of event
falls within the corresponding interval.
This statistic assumes that censoring time is independent of death time.
A model is well D-calibrated if \(s \sim Unif(B)\), tested with chisq.test
(\(p &amp;gt; 0.05\) if well-calibrated, i.e. higher p-values are preferred).
Model \(i\) is better calibrated than model \(j\) if \(s(i) &amp;lt; s(j)\),
meaning that lower values of this measure are preferred."><meta property="og:description" content="
This calibration method is defined by calculating the following statistic:
$$s = B/n \sum_i (P_i - n/B)^2$$
where \(B\) is number of 'buckets' (that equally divide \([0,1]\) into intervals),
\(n\) is the number of predictions, and \(P_i\) is the observed proportion
of observations in the \(i\)th interval. An observation is assigned to the
\(i\)th bucket, if its predicted survival probability at the time of event
falls within the corresponding interval.
This statistic assumes that censoring time is independent of death time.
A model is well D-calibrated if \(s \sim Unif(B)\), tested with chisq.test
(\(p &amp;gt; 0.05\) if well-calibrated, i.e. higher p-values are preferred).
Model \(i\) is better calibrated than model \(j\) if \(s(i) &amp;lt; s(j)\),
meaning that lower values of this measure are preferred."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlr3proba</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="external-link dropdown-item" href="https://survival-org.github.io/user2024-survival-mlr3/">userR! 2024 Tutorial</a></li>
    <li><a class="external-link dropdown-item" href="https://mlr3book.mlr-org.com/chapters/chapter13/beyond_regression_and_classification.html#sec-survival">Survival Analysis (mlr3 book)</a></li>
    <li><a class="external-link dropdown-item" href="https://mlr3book.mlr-org.com/chapters/chapter13/beyond_regression_and_classification.html#sec-density">Density Estimation (mlr3 book)</a></li>
    <li><a class="external-link dropdown-item" href="https://mlr-org.com/gallery/technical/2023-10-25-bart-survival/">Survival Modeling using BART</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-book"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/mlr3proba/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/" aria-label="Mattermost"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3" aria-label="Stack Overflow"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/" aria-label="mlr3 website"><span class="fa fa-link"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>D-Calibration Survival Measure</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3proba/blob/v0.8.4/R/MeasureSurvDCalibration.R" class="external-link"><code>R/MeasureSurvDCalibration.R</code></a></small>
      <div class="d-none name"><code>mlr_measures_surv.dcalib.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>This calibration method is defined by calculating the following statistic:
$$s = B/n \sum_i (P_i - n/B)^2$$
where \(B\) is number of 'buckets' (that equally divide \([0,1]\) into intervals),
\(n\) is the number of predictions, and \(P_i\) is the observed proportion
of observations in the \(i\)th interval. An observation is assigned to the
\(i\)th bucket, if its predicted survival probability at the time of event
falls within the corresponding interval.
This statistic assumes that censoring time is independent of death time.</p>
<p>A model is well D-calibrated if \(s \sim Unif(B)\), tested with <code>chisq.test</code>
(\(p &gt; 0.05\) if well-calibrated, i.e. higher p-values are preferred).
Model \(i\) is better calibrated than model \(j\) if \(s(i) &lt; s(j)\),
meaning that <em>lower values</em> of this measure are preferred.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This measure can either return the test statistic or the p-value from the <code>chisq.test</code>.
The former is useful for model comparison whereas the latter is useful for determining if a model
is well-calibrated. If <code>chisq = FALSE</code> and <code>s</code> is the predicted value then you can manually
compute the p.value with <code>pchisq(s, B - 1, lower.tail = FALSE)</code>.</p>
<p><strong>NOTE</strong>: This measure is still experimental both theoretically and in implementation. Results
should therefore only be taken as an indicator of performance and not for
conclusive judgements about model calibration.</p>
    </div>
    <div class="section level2">
    <h2 id="dictionary">Dictionary<a class="anchor" aria-label="anchor" href="#dictionary"></a></h2>


<p>This <a href="https://mlr3.mlr-org.com/reference/Measure.html" class="external-link">Measure</a> can be instantiated via the <a href="https://mlr3misc.mlr-org.com/reference/Dictionary.html" class="external-link">dictionary</a>
<a href="https://mlr3.mlr-org.com/reference/mlr_measures.html" class="external-link">mlr_measures</a> or with the associated sugar function <a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr()</a>:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>MeasureSurvDCalibration<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>mlr_measures<span class="sc">$</span><span class="fu">get</span>(<span class="st">"surv.dcalib"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">msr</span>(<span class="st">"surv.dcalib"</span>)</span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a></h2>

<table class="table table"><tr><td>Id</td><td>Type</td><td>Default</td><td>Levels</td><td>Range</td></tr><tr><td>B</td><td>integer</td><td>10</td><td></td><td>\([1, \infty)\)</td></tr><tr><td>chisq</td><td>logical</td><td>FALSE</td><td>TRUE, FALSE</td><td>-</td></tr><tr><td>truncate</td><td>numeric</td><td>Inf</td><td></td><td>\([0, \infty)\)</td></tr></table></div>
    <div class="section level2">
    <h2 id="meta-information">Meta Information<a class="anchor" aria-label="anchor" href="#meta-information"></a></h2>


<ul><li><p>Type: <code>"surv"</code></p></li>
<li><p>Range: \([0, \infty)\)</p></li>
<li><p>Minimize: <code>TRUE</code></p></li>
<li><p>Required prediction: <code>distr</code></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="parameter-details">Parameter details<a class="anchor" aria-label="anchor" href="#parameter-details"></a></h2>


<ul><li><p><code>B</code> (<code>integer(1)</code>) <br>
Number of buckets to test for uniform predictions over.
Default of <code>10</code> is recommended by Haider et al. (2020).
Changing this parameter affects <code>truncate</code>.</p></li>
<li><p><code>chisq</code> (<code>logical(1)</code>) <br>
If <code>TRUE</code> returns the p-value of the corresponding chisq.test instead of the measure.
Default is <code>FALSE</code> and returns the statistic <code>s</code>.
You can manually get the p-value by executing <code>pchisq(s, B - 1, lower.tail = FALSE)</code>.
The null hypothesis is that the model is D-calibrated.</p></li>
<li><p><code>truncate</code> (<code>double(1)</code>) <br>
This parameter controls the upper bound of the output statistic, when <code>chisq</code> is <code>FALSE</code>.
We use <code>truncate = Inf</code> by default but values between \(10-16\) are sufficient
for most purposes, which correspond to p-values of \(0.35-0.06\) for the <code>chisq.test</code> using
the default \(B = 10\) buckets.
Values \(B &gt; 10\) translate to even lower p-values and thus less D-calibrated models.
If the number of buckets \(B\) changes, you probably will want to
change the <code>truncate</code> value as well to correspond to the same p-value significance.
Note that truncation may severely limit automated tuning with this measure.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Haider, Humza, Hoehn, Bret, Davis, Sarah, Greiner, Russell (2020).
“Effective Ways to Build and Evaluate Individual Survival Distributions.”
<em>Journal of Machine Learning Research</em>, <b>21</b>(85), 1–63.
<a href="https://jmlr.org/papers/v21/18-772.html" class="external-link">https://jmlr.org/papers/v21/18-772.html</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other survival measures:
<code><a href="mlr_measures_surv.calib_alpha.html">mlr_measures_surv.calib_alpha</a></code>,
<code><a href="mlr_measures_surv.calib_beta.html">mlr_measures_surv.calib_beta</a></code>,
<code><a href="mlr_measures_surv.calib_index.html">mlr_measures_surv.calib_index</a></code>,
<code><a href="mlr_measures_surv.chambless_auc.html">mlr_measures_surv.chambless_auc</a></code>,
<code><a href="mlr_measures_surv.cindex.html">mlr_measures_surv.cindex</a></code>,
<code><a href="mlr_measures_surv.graf.html">mlr_measures_surv.graf</a></code>,
<code><a href="mlr_measures_surv.hung_auc.html">mlr_measures_surv.hung_auc</a></code>,
<code><a href="mlr_measures_surv.intlogloss.html">mlr_measures_surv.intlogloss</a></code>,
<code><a href="mlr_measures_surv.logloss.html">mlr_measures_surv.logloss</a></code>,
<code><a href="mlr_measures_surv.mae.html">mlr_measures_surv.mae</a></code>,
<code><a href="mlr_measures_surv.mse.html">mlr_measures_surv.mse</a></code>,
<code><a href="mlr_measures_surv.nagelk_r2.html">mlr_measures_surv.nagelk_r2</a></code>,
<code><a href="mlr_measures_surv.oquigley_r2.html">mlr_measures_surv.oquigley_r2</a></code>,
<code><a href="mlr_measures_surv.rcll.html">mlr_measures_surv.rcll</a></code>,
<code><a href="mlr_measures_surv.rmse.html">mlr_measures_surv.rmse</a></code>,
<code><a href="mlr_measures_surv.schmid.html">mlr_measures_surv.schmid</a></code>,
<code><a href="mlr_measures_surv.song_auc.html">mlr_measures_surv.song_auc</a></code>,
<code><a href="mlr_measures_surv.song_tnr.html">mlr_measures_surv.song_tnr</a></code>,
<code><a href="mlr_measures_surv.song_tpr.html">mlr_measures_surv.song_tpr</a></code>,
<code><a href="mlr_measures_surv.uno_auc.html">mlr_measures_surv.uno_auc</a></code>,
<code><a href="mlr_measures_surv.uno_tnr.html">mlr_measures_surv.uno_tnr</a></code>,
<code><a href="mlr_measures_surv.uno_tpr.html">mlr_measures_surv.uno_tpr</a></code>,
<code><a href="mlr_measures_surv.xu_r2.html">mlr_measures_surv.xu_r2</a></code></p>
<p>Other calibration survival measures:
<code><a href="mlr_measures_surv.calib_alpha.html">mlr_measures_surv.calib_alpha</a></code>,
<code><a href="mlr_measures_surv.calib_beta.html">mlr_measures_surv.calib_beta</a></code>,
<code><a href="mlr_measures_surv.calib_index.html">mlr_measures_surv.calib_index</a></code></p>
<p>Other distr survival measures:
<code><a href="mlr_measures_surv.calib_alpha.html">mlr_measures_surv.calib_alpha</a></code>,
<code><a href="mlr_measures_surv.calib_index.html">mlr_measures_surv.calib_index</a></code>,
<code><a href="mlr_measures_surv.graf.html">mlr_measures_surv.graf</a></code>,
<code><a href="mlr_measures_surv.intlogloss.html">mlr_measures_surv.intlogloss</a></code>,
<code><a href="mlr_measures_surv.logloss.html">mlr_measures_surv.logloss</a></code>,
<code><a href="mlr_measures_surv.rcll.html">mlr_measures_surv.rcll</a></code>,
<code><a href="mlr_measures_surv.schmid.html">mlr_measures_surv.schmid</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="super-classes">Super classes<a class="anchor" aria-label="anchor" href="#super-classes"></a></h2>
    <p><code><a href="https://mlr3.mlr-org.com/reference/Measure.html" class="external-link">mlr3::Measure</a></code> -&gt; <code><a href="MeasureSurv.html">mlr3proba::MeasureSurv</a></code> -&gt; <code>MeasureSurvDCalibration</code></p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-MeasureSurvDCalibration-new"><code>MeasureSurvDCalibration$new()</code></a></p></li>
<li><p><a href="#method-MeasureSurvDCalibration-clone"><code>MeasureSurvDCalibration$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="mlr3" data-topic="Measure" data-id="aggregate"><a href="https://mlr3.mlr-org.com/reference/Measure.html#method-aggregate"><code>mlr3::Measure$aggregate()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Measure" data-id="format"><a href="https://mlr3.mlr-org.com/reference/Measure.html#method-format"><code>mlr3::Measure$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Measure" data-id="help"><a href="https://mlr3.mlr-org.com/reference/Measure.html#method-help"><code>mlr3::Measure$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Measure" data-id="print"><a href="https://mlr3.mlr-org.com/reference/Measure.html#method-print"><code>mlr3::Measure$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Measure" data-id="score"><a href="https://mlr3.mlr-org.com/reference/Measure.html#method-score"><code>mlr3::Measure$score()</code></a></span></li>
</ul></details></p><hr><a id="method-MeasureSurvDCalibration-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates a new instance of this <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/mlr_measures_surv.dcalib.html">MeasureSurvDCalibration</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-MeasureSurvDCalibration-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">MeasureSurvDCalibration</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphael Sonabend, Franz Kiraly, Michel Lang, John Zobolas, Philip Studener.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

